%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%                                                                              %
% SU2 configuration file                                                       %
% Case description: Incompressible Cylinder (Nondimensional case) - POST RUN   %
%                                                                              %
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


% ------------- DIRECT, ADJOINT, AND LINEARIZED PROBLEM DEFINITION ------------%

% Solver to use for incompressible flow case: INC_EULER, INC_NAVIER_STOKES, or INC_RANS
SOLVER = INC_NAVIER_STOKES
% Mathematical problem (DIRECT, CONTINUOUS_ADJOINT, LINEARIZED)
MATH_PROBLEM = DIRECT      % Use DIRECT for standard CFD simulation


% -------------------------- RESTART SETTINGS -------------------------%
RESTART_SOL = YES                                   % Enable restart from a saved solution
% User must change the name of the saved file "restart_flow.dat" to "solution_flow.dat"
% For transient simulation, the user must change the last two files "restart_flow_31998.dat" and "restart_flow_31999.dat" to "solution_flow_31998.dat" and "solution_flow_31999.dat"
SOLUTION_FILENAME= solution_flow                    % File from which the simulation will restart

% If unsteady, optionally specify iteration to restart from:
RESTART_ITER = 32000                                % Set iteration number for unsteady restart

% -------------------- INCOMPRESSIBLE FREE-STREAM DEFINITION --------------------%

% Initial density for incompressible flows
INC_DENSITY_INIT = 1.0

% Initial velocity for incompressible flows
INC_VELOCITY_INIT = (1.0, 0.0, 0.0)

% Inlet & Outlet markers for incompressible flow
INC_INLET_TYPE = VELOCITY_INLET
INC_OUTLET_TYPE = PRESSURE_OUTLET

% Flow orientation
AOA = 0.0
SIDESLIP_ANGLE = 0.0


% --------------------------- VISCOSITY MODEL DEFINITION ---------------------------------%

% Viscosity model (SUTHERLAND, CONSTANT_VISCOSITY).
VISCOSITY_MODEL= CONSTANT_VISCOSITY

%MU_CONSTANT from a target Reynolds number when running non-dimensional case
% Re = 100
MU_CONSTANT = 0.01

% ---------------------- REFERENCE VALUE DEFINITION ---------------------------%
REF_ORIGIN_MOMENT_X = 0.00
REF_ORIGIN_MOMENT_Y = 0.00
REF_ORIGIN_MOMENT_Z = 0.00
REF_LENGTH = 1.0
REF_AREA = 1.0


% -------------------- BOUNDARY CONDITION DEFINITION --------------------------%
MARKER_HEATFLUX = (cylinder, 0.0)                % Viscous wall (no-slip)
MARKER_SYM = (wall)                              % Symmetry plane

% Incompressible inlet marker: (inlet_marker, T, U, u, v, w)
MARKER_INLET = (inlet, 0.0, 1.0, 1.0, 0.0, 0.0)
% Incompressible outlet marker: (outlet_marker, P)
MARKER_OUTLET = (outlet, 0.0)

% Output / monitoring
MARKER_PLOTTING = (cylinder)
MARKER_MONITORING = (cylinder)







% ------------- COMMON PARAMETERS DEFINING THE NUMERICAL METHOD ---------------%

% Numerical method for spatial gradients (GREEN_GAUSS, WEIGHTED_LEAST_SQUARES)
NUM_METHOD_GRAD= WEIGHTED_LEAST_SQUARES
CFL_NUMBER= 1.0
CFL_ADAPT= NO
%CFL_ADAPT_PARAM= ( 0.1, 2.0, 100.0, 1e10 )
%ITER= 1000           % Used for steady case only


% ------------------------ LINEAR SOLVER DEFINITION ---------------------------%
%
% Linear solver for implicit formulations (BCGSTAB, FGMRES)
LINEAR_SOLVER= FGMRES
%
% Preconditioner of the Krylov linear solver (JACOBI, LINELET, LU_SGS)
LINEAR_SOLVER_PREC= ILU
%
% Minimum error of the linear solver for implicit formulations
LINEAR_SOLVER_ERROR= 1E-6
%
% Max number of iterations of the linear solver for the implicit formulation
LINEAR_SOLVER_ITER= 10



% -------------------------- MULTIGRID PARAMETERS -----------------------------%
%
% Multi-Grid Levels (0 = no multi-grid)
MGLEVEL= 0
%
% Multi-grid cycle (V_CYCLE, W_CYCLE, FULLMG_CYCLE)
MGCYCLE= W_CYCLE
%
% Multi-grid pre-smoothing level
MG_PRE_SMOOTH= ( 1, 2, 3, 3 )
%
% Multi-grid post-smoothing level
MG_POST_SMOOTH= ( 0, 0, 0, 0 )
%
% Jacobi implicit smoothing of the correction
MG_CORRECTION_SMOOTH= ( 0, 0, 0, 0 )
%
% Damping factor for the residual restriction
MG_DAMP_RESTRICTION= 0.9
%
% Damping factor for the correction prolongation
MG_DAMP_PROLONGATION= 0.9



% -------------------- FLOW NUMERICAL METHOD DEFINITION -----------------------%

% Convective numerical method (JST, LAX-FRIEDRICH, CUSP, ROE, AUSM, HLLC, TURKEL_PREC, MSW)
CONV_NUM_METHOD_FLOW = FDS   % HLLC

% Monotonic Upwind Scheme for Conservation Laws (TVD) in the flow equations. Required for 2nd order upwind schemes (NO, YES)
MUSCL_FLOW = YES

% Slope limiter (NONE, VENKATAKRISHNAN, VENKATAKRISHNAN_WANG, BARTH_JESPERSEN, VAN_ALBADA_EDGE)
SLOPE_LIMITER_FLOW= VENKATAKRISHNAN_WANG

% Coefficient for the limiter (smooth regions)
VENKAT_LIMITER_COEFF= 0.05

% 2nd and 4th order artificial dissipation coefficients
JST_SENSOR_COEFF= ( 0.5, 0.02 )




% --------------------------- TIME DISCRETIZATION DEFINITION ---------------------------------%
% TRANSIENT SETTING

% Time discretization (RUNGE-KUTTA_EXPLICIT, EULER_IMPLICIT, EULER_EXPLICIT)
TIME_DISCRE_FLOW= EULER_IMPLICIT


TIME_DOMAIN = YES                                    % Unsteady (time-dependent) simulation
TIME_MARCHING = DUAL_TIME_STEPPING-2ND_ORDER         % Unsteady solver
TIME_STEP = 6.25e-3                                  % Nondimensional time-step (Î”t)
MAX_TIME = 225                                       % Total simulation time to cover (T)
TIME_ITER = 36000                                    % Number of time-step to run (N)
INNER_ITER = 10                                      % Max number of sub-iterations per time step for convergence (btw 10 and 50)



% --------------------------- CONVERGENCE PARAMETERS --------------------------%
%
% Convergence criteria (CAUCHY, RESIDUAL)
CONV_FIELD= RMS_DENSITY
%
% Min value of the residual (log10 of the residual)
CONV_RESIDUAL_MINVAL= -12
%
% Start convergence criteria at iteration number
CONV_STARTITER= 10
%
% Number of elements to apply the criteria
CONV_CAUCHY_ELEMS= 100
%
% Epsilon to control the series convergence
CONV_CAUCHY_EPS= 1E-6



% ------------------------- INPUT/OUTPUT INFORMATION --------------------------%

% Input files
MESH_FILENAME= unstructured_grid.su2
MESH_FORMAT= SU2

% Output files
%MESH_OUT_FILENAME= mesh_out.su2                     % Used to output a modified mesh (adaptive mesh refinement)
%SOLUTION_FILENAME= solution_flow.dat                % Used to start a simulation from a previous run
TABULAR_FORMAT= CSV
CONV_FILENAME= history_post
RESTART_FILENAME= restart_flow_post.dat
VOLUME_FILENAME= flow_post
%GRAD_OBJFUNC_FILENAME= of_grad.dat                  % Only used for adjoint optimization (not used in DIRECT simulations)
SURFACE_FILENAME= surface_flow_post

% Writing solution file frequency
OUTPUT_WRT_FREQ = 20                                 % Outputs every 20 steps
SCREEN_WRT_FREQ_INNER = 1



% STEADY SETTING
%SCREEN_OUTPUT = (INNER_ITER, WALL_TIME, RMS_VELOCITY-X, RMS_VELOCITY-Y, RMS_PRESSURE, LIFT, DRAG)   % RMS_DENSITY, RMS_ENERGY don't work here since incompressible flow
%HISTORY_OUTPUT= (INNER_ITER, WALL_TIME, RMS_VELOCITY-X, RMS_VELOCITY-Y, RMS_PRESSURE, LIFT, DRAG)

% TRANSIENT SETTING
SCREEN_OUTPUT = (TIME_ITER, CUR_TIME, RMS_RES, LIST, LIFT, DRAG)   % RMS_DENSITY, RMS_ENERGY don't work here since incompressible flow
HISTORY_OUTPUT= (TIME_ITER, CUR_TIME, RMS_RES, LIST, LIFT, DRAG)
